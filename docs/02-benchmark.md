# Galay-Kernel æ€§èƒ½å‹æµ‹æŠ¥å‘Š

æœ¬æ–‡æ¡£ä¸ºæ€§èƒ½å‹æµ‹æ•°æ®æ±‡æ€»ï¼Œè¯¦ç»†æ•°æ®è¯·å‚è€ƒå„æ¨¡å—æ–‡æ¡£ã€‚

## æµ‹è¯•å¹³å°

| å¹³å° | æ“ä½œç³»ç»Ÿ | æ¶æ„ | CPU | å†…å­˜ | IO æ¨¡å‹ |
|------|---------|------|-----|------|---------|
| macOS | Darwin 24.6.0 | ARM64 | Apple M4, 10æ ¸ | 24GB | kqueue |
| Linux | Linux 6.8.0-90-generic | x86_64 | Intel i7-14700K, 8æ ¸ | 8GB | epoll / io_uring |

---

## æ€§èƒ½æ€»è§ˆ

### ç½‘ç»œ IO (TCP)

| å¹³å° | IO æ¨¡å‹ | QPS | ååé‡ | è¯„çº§ |
|------|---------|-----|--------|------|
| macOS | **kqueue** | **313,841** | **153.24 MB/s** | â­â­â­â­â­ å“è¶Š |
| Linux | io_uring | 230,066 | 112.34 MB/s | â­â­â­â­â­ ä¼˜ç§€ |
| Linux | epoll | 190,775 | 93.15 MB/s | â­â­â­â­â­ ä¼˜ç§€ |

è¯¦ç»†æ•°æ®: [07-network-io.md](07-network-io.md#æ€§èƒ½å‹æµ‹æ•°æ®)

### ç½‘ç»œ IO (UDP)

| å¹³å° | IO æ¨¡å‹ | QPS | ååé‡ | ä¸¢åŒ…ç‡ |
|------|---------|-----|--------|--------|
| macOS | kqueue | 35,008 | 8.55 MB/s | 0.00% |
| Linux | io_uring | 35,082 | 8.56 MB/s | 0.00% |
| Linux | epoll | 35,082 | 8.56 MB/s | 0.00% |

è¯¦ç»†æ•°æ®: [04-udp-benchmark.md](04-udp-benchmark.md)

### æ–‡ä»¶ IO

| å¹³å° | IO æ¨¡å‹ | IOPS | ååé‡ | è¯„çº§ |
|------|---------|------|--------|------|
| macOS | kqueue | 38,095 | 148.81 MB/s | â­â­â­â­â­ å“è¶Š |
| Linux | io_uring | 20,000 | 78.12 MB/s | â­â­â­â­â­ ä¼˜ç§€ |
| Linux | epoll + libaio | 13,260 | 51.80 MB/s | â­â­â­â­ è‰¯å¥½ |

> **æ³¨æ„**: ä¸åŒå¹³å°çš„æ–‡ä»¶ IO å®ç°æ–¹å¼ä¸åŒï¼Œæ€§èƒ½æ•°æ®ä¸èƒ½ç›´æ¥å¯¹æ¯”ï¼š
> - **kqueue / io_uring**: ä½¿ç”¨æ™®é€šæ–‡ä»¶æ¨¡å¼ï¼Œå¯åˆ©ç”¨æ“ä½œç³»ç»Ÿé¡µç¼“å­˜ï¼Œçƒ­æ•°æ®è®¿é—®æå¿«
> - **epoll + libaio**: å¿…é¡»ä½¿ç”¨ `O_DIRECT` æ¨¡å¼ï¼Œç»•è¿‡é¡µç¼“å­˜ï¼Œæ¯æ¬¡éƒ½æ˜¯çœŸå®ç£ç›˜ IO
>
> epoll + libaio çš„æµ‹è¯•åæ˜ çš„æ˜¯**çœŸå®ç£ç›˜æ€§èƒ½**ï¼Œé€‚åˆå¤§æ–‡ä»¶é¡ºåº IO åœºæ™¯ï¼ˆæ•°æ®åº“ã€æ—¥å¿—ç³»ç»Ÿï¼‰ã€‚
> æµ‹è¯•å‚æ•°ï¼š`-w 1 -batch 16`ï¼ˆå• workerï¼Œæ‰¹é‡ 16ï¼‰

è¯¦ç»†æ•°æ®: [08-file-io.md](08-file-io.md#æ€§èƒ½å‹æµ‹æ•°æ®)

### ComputeScheduler

| å¹³å° | ä»»åŠ¡ç±»å‹ | ååé‡ | å»¶è¿Ÿ |
|------|----------|--------|------|
| macOS (M4) | ç©ºä»»åŠ¡ | 4,000,000 tasks/s | - |
| macOS (M4) | è½»é‡è®¡ç®— | 5,000,000 tasks/s | - |
| macOS (M4) | é‡è®¡ç®— | 1,111,111 tasks/s | - |
| macOS (M4) | è°ƒåº¦å»¶è¿Ÿ | - | 7.01 Î¼s |
| Linux (i7-14700K) | ç©ºä»»åŠ¡ | 1,351,351 tasks/s | - |
| Linux (i7-14700K) | è½»é‡è®¡ç®— | 1,136,364 tasks/s | - |
| Linux (i7-14700K) | é‡è®¡ç®— | 196,078 tasks/s | - |
| Linux (i7-14700K) | è°ƒåº¦å»¶è¿Ÿ | - | 1620.96 Î¼s |

è¯¦ç»†æ•°æ®: [03-compute-scheduler.md](03-compute-scheduler.md)

### MpscChannel

| å¹³å° | åœºæ™¯ | ååé‡ | å»¶è¿Ÿ |
|------|------|--------|------|
| macOS (M4) | å•ç”Ÿäº§è€… | 27,777,778 msg/s | - |
| macOS (M4) | å¤šç”Ÿäº§è€… (4çº¿ç¨‹) | 27,777,778 msg/s | - |
| macOS (M4) | æ‰¹é‡æ¥æ”¶ | 37,037,037 msg/s | - |
| macOS (M4) | è·¨è°ƒåº¦å™¨ | 28,571,429 msg/s | - |
| Linux (i7-14700K) | å•ç”Ÿäº§è€… | 5,235,602 msg/s | - |
| Linux (i7-14700K) | å¤šç”Ÿäº§è€… (4çº¿ç¨‹) | 5,376,344 msg/s | - |
| Linux (i7-14700K) | æ‰¹é‡æ¥æ”¶ | 14,705,882 msg/s | - |
| Linux (i7-14700K) | è·¨è°ƒåº¦å™¨ | 5,128,205 msg/s | - |
| Linux (i7-14700K) | æŒç»­è´Ÿè½½ | 4,819,086 msg/s | 6159.23 Î¼s |

è¯¦ç»†æ•°æ®: [09-concurrency.md](09-concurrency.md)

---

## å…³é”®ç»“è®º

### ç½‘ç»œ IO
- ğŸ¥‡ **kqueue (macOS)**: æ€§èƒ½æœ€ä¼˜ï¼Œ31ä¸‡+ QPS
- ğŸ¥ˆ **io_uring (Linux)**: æ€§èƒ½ä¼˜ç§€ï¼Œ23ä¸‡+ QPS
- ğŸ¥‰ **epoll (Linux)**: æ€§èƒ½è‰¯å¥½ï¼Œ19ä¸‡+ QPS

### æ–‡ä»¶ IO
- ğŸš€ **kqueue (macOS)**: 38,095 IOPS
- ğŸš€ **io_uring (Linux)**: 20,000 IOPS
- ğŸš€ **epoll (Linux)**: 20,000 IOPS

### ComputeScheduler
- âš¡ **macOS (M4)**: 400ä¸‡+ tasks/sï¼Œå»¶è¿Ÿ 7.01 Î¼s
- âš¡ **Linux (i7-14700K)**: 135ä¸‡+ tasks/s

### MpscChannel
- âš¡ **macOS (M4)**: 2777ä¸‡+ msg/s
- âš¡ **Linux (i7-14700K)**: 523ä¸‡+ msg/sï¼Œæ‰¹é‡æ¥æ”¶ 1470ä¸‡+ msg/s

### ç”Ÿäº§å°±ç»ªåº¦
- âœ… æ‰€æœ‰å¹³å°é›¶é”™è¯¯ç‡
- âœ… ç¨³å®šæ€§ä¼˜ç§€
- âœ… æ¨èç”Ÿäº§ä½¿ç”¨

---

## å‹æµ‹å‘½ä»¤

### ç½‘ç»œ IO (TCP)
```bash
# æœåŠ¡å™¨
./bin/bench_tcp_server 8080

# å®¢æˆ·ç«¯
./bin/bench_tcp_client 127.0.0.1 8080 100 256 10
```

### ç½‘ç»œ IO (UDP)
```bash
./bin/bench_udp
```

### æ–‡ä»¶ IO
```bash
./bin/bench_file_io
```

### ComputeScheduler
```bash
./bin/bench_compute_scheduler
```

### MpscChannel
```bash
./bin/bench_mpsc_channel
```

---

**æŠ¥å‘Šæ›´æ–°æ—¶é—´**: 2026-01-10
